# Witness

#### Description

Prove that you have knowledge about something that no one can see and submit the corresponding hash.

#### Resources

Witness.circom

```
include "./poseidon.circom";


template SecureInnerCircuit() {
    signal input prime;
    signal input pre_commitment;
    signal input challenge;       /* Value between prime//2 - prime */
    signal input randomizer;      /* Value between prime//2 - prime */
    signal input blinding_factor; /* Value between prime//2 - prime */

    signal commitment;
    commitment <-- (pre_commitment * challenge) % prime;

    signal temp_masked;
    temp_masked <== commitment + randomizer;

    signal remainder;
    remainder <-- temp_masked % prime;

    signal output g;
    signal output h;
    g <== 5;
    h <== 7;

    signal val1;
    signal val2;
    signal pedersen_commitment;

    val1 <== g * remainder
    val1 <-- val1 % prime
    val2 <== h * blinding_factor
    val2 <-- val2 % prime

    pedersen_commitment <-- (val1 + val2) % prime;

    component poseidon = Poseidon(2);
    poseidon.inputs[0] <== remainder;
    poseidon.inputs[1] <== blinding_factor;

    signal poseidon_hash;
    poseidon_hash <== poseidon.out;

    signal fake_1;
    signal fake_2;
    fake_1 <-- (randomizer + 3) * challenge;
    fake_2 <-- (fake_1 - randomizer) ^ 2 % prime;

    signal output leaked_hash;
    signal output leaked_commitment;
    

    leaked_commitment <== pedersen_commitment;
    leaked_hash <== poseidon_hash;
}

component main = SecureInnerCircuit();

```

Witness generation and understanding how it works in the key factor to solve the given chall.

while compiling the circom circuit files 
using command `circom witness.circom --r1cs --sym --wtns -o build` will create all the files required for the chall and `.wtns` is witness file which contains all the input and ouptut generated during running the circuits.

We can convert `.wtns` file to json file which is given already while generating challenge.

`witness.circom` have inputs as `prime`, `pre_commitment`, `challenge` & `randomizer` given by user while `/generate_challenge` keeping it constrainted.

- Moving to login page.
  
![image](https://github.com/CyberLabs-Infosec/PearlCTF_Challenges_Public_2025/blob/main/crypto/Witness/image/login.jpg)

- Creating user.
  
![image](https://github.com/CyberLabs-Infosec/PearlCTF_Challenges_Public_2025/blob/main/crypto/Witness/image/register.jpg)

- Thereafter logging in, we will move to this page.
  
![image](https://github.com/CyberLabs-Infosec/PearlCTF_Challenges_Public_2025/blob/main/crypto/Witness/image/challenge.jpg)

- At first generating challenge.
  
![image](https://github.com/CyberLabs-Infosec/PearlCTF_Challenges_Public_2025/blob/main/crypto/Witness/image/generate_challenge.jpg)


we can pick any challenge and randomizer for generation of challenge.

```
This is witness: ["1","5","7","3077441","8300557270016853654217686415541469010953091753111651488749227335704826383295","8995003","5188827","4497502","4497502","xxxxxxxxx","426281677759936592021316809065178817848084678679510574715894138690252734162","21495955518452491401905142468335101741033844246839945434046596027310043709734","8297172585040741147384885303822862444509286865197264290915831227085074456682","3788112291278118922690287159882723601384567106092135109078489920230771941722","11438788052378148201696186251694870089651797536947999736357638180819509483731","14558704202166392216186726639121131989597517813187181398815162599320726866399","8752572952703196807479348350822840596955669649191388783998212994727696973771","19866103321059822276712280713488126029519511759596231680261555161918811983502","18010300722096210125268797511918248597575033836607716976714584194710833235262","14958697941989064204302653522981043879572320840915641109302873587444296638987","4558340775852683776313176960936349537787618873401735173767592619097913600279","5413897875107038320308695912448899792590211722319958931312644131339713981415","5472857323397527047486446422613263582618083428300859909430658300402134792571","15369796911992406765853096166475464592787136959964675296325558494039467527408","8659036764267075656399069917733600469604588358312289545085797591468005829122","19030486180679196972671118085542895182744070236447829236071711262432040100598","17074540388773516431024449797512484011654031318074564389580858244720962098496","15900142041357464414337741148491343074320798052989325907700634712184347175612","18711975435802173498337164389577772788984762068759937762998738186437487567203","4828846712694310801321713715820458295157520078621267265499292054632943968374","13733345167435082025164892912148618964448812348567023048622891742479654938464","8037675394986927947873222687531718086816404663993023269059829901440908134318","19561334595603753444871376603302469094119582338123925938983425936701728851229","13975994515268313309673236040126290211660372552253501801670506418702985624124","13442324509454233447758446849471231328162254345817427555828576230411944158441","12037908501380962149236510887194474065782691467827174922644422886082881319591","19724405357753813793536223377214660475076258851587853682801248098431454259309","15830764449424030554825896575106126453801770622976609671018032067549096540051","5566642193311765552877372018715500570875991999479497623702772708763222071183","16578149130684708037625247146969446542943843237545524680489199701059651082396","10017295885144130760131398950804176885225514769851585118292049060877956654469","4567988701699027406272531960261280869422836580569049273152974358372323693157","1471414674187764262320854522861068437436290151266088025414975701759175147333","21236859387401602756413754265626546265747833693626187830688126666161022933685","7078017906682850571769661794852387235077751700424259052733449054511257697410","3512442412520546179512786344523527297454676433793164590105068455096205036526","16014500951079191275865941547606602814172256127656785520913392354125998852303","4314307453215050398361107340710449796607263595127544067964908784574095128948","8275465695865746054983761103990015991896579849297982980520334765557160357926","16689198956383237329158621300345692377079385371335418220990222894739647237248","2668154525860117330630243034240267072245432207969097970994969944534486178585","1331156624382938836875228592991396780264305647552447940488121021090220837474","20687681603008035681139880663888850575302317587185619513575241026997573675719","14569790653556014264325242538481163950113714526682757190050445009726406819605","2272672005238427381243710496788842109927311727607779737844329211883183668883","21743523468366090452193806113665386514367589900164207544474065750459181915945","2189041867812654305345410776265613370083242213280204511487566677105471115249","4313634194260544264467339447056831678049163539154203437919953994122441245667","8356235672619152539156090671342512601828225834493120630475151263495343003955","3497256904810900199287715356598959705854808813675087333381316590443872631064","19256915712945368809272011465139230607854999785275986307722987308754675637514","8064340668935425658582616558601944267239651803147096860447220872535195650253","9970260178623543842759353674456873837880160441798611709402795002534466153664","16850136875930036154091676632775254049460775302335578737452273278642626121521","12259428539186661801919454806291714986086682168889895334597021514780507220489","5092094968422235805042334068347097582965072156255091205375073898180222962687","21128599477685889273628150839733362498899522784898375556211841321222012958482","673270500664207497058070892111819084214584407338815210912192570799779340749","3575054229369368297981510089584580409560681322733189606983782350410006764023","17590224023148007920383477458487376590449137003785804310990957848705693589329","3068117298551198888521394299341134469899444965837694595917224309540418419437","15860942371572109543509057788675415845037584553793322796651229553561474413800","20406918115069566195957873273641995903867268355361783724528342634650697682221","15904293797651428264582975926079554945278804862573895124113725975310351955703","11564582275323151376126141513802455261377851886678384347989718315352070858919","3695204970565597278599400660895588943822509519154649403431251787255145001065","14931520595914614571241811376915767710818848434202615845460524820647291247894","1629640226657222994379536513389825151041995590387530943169694257348031128447","11068539034444439293594254180310206550600751802096503129251214596292157943297","6853128860138387245319215441621199040228202599149534408569338119215232969591","9251297145735245033359274446499470231389305651036366459345431703623184588993","4715943322756301934034800706090413976281622805838818866562991087976806729651","3333195612196646032944675546057416817132418417288163688388698252095804363225","8636161841157323397365009319066542370739938528007720538738039184991594248925","15595389878291280031414476696560667993910793705886468788432812332787463210226","9661525667289618831759948145633977244208940113195206258148399743163047670279","134197359697803367848781207311026877118543534020950394485274325128824523558","14135472193728243274011934601786946028470119064996167359261556115495542546121","21342886432506041605314849156848934941924254556520982709462908213124664263740","16997545241533662153530848049829953492058022069826781331153783656556069294852","13436942429588353084310490304304253405956284212830279531734722421986820371256","21079997308386590413605889838093766215191572267343633877461825812782728665387","3990195598463660752075541778950978430473026845987767823352654766614470244619","1707755766132966192464715364476561763925646929695385105741682141180398140649","21183974194147738612077272232731048089337267907937327888126039320036447462098","1848935771655578447899695863656420810756754207563989123112969729698952110102","204996197476371440618552872482740507864601474081857919564418340430290180263","4757519822134282004259070102448698580382487369054218629038282393413379864935","17281309135908474762993352071919693987195059523315394926247322994731020051354","5123872241516269747694700015255748419740335899712999651667900454487876759653","3498854625630780572105596888558008448032662378217768049477070039246254490794","13425244032124474865274820605684284668194986168014099888862138757154897537295","2510324393023027476805228887074072978452880357190973053308936035897772929102","20616117619953027813488419602362459260709420294922404507941956048017191249768","19812977839639529674302645798633875969066745146046310562745389312123049646418","13419318129968676396270818187048757419018692601039362790964663426311710024539","17169106801761069149763399892707390098579567955059480846982524805230629099250","2447902605833975759260567255651237343605077115047011228961684173073514943654","3969685903855442765935672138716777370220907759859233775441362594622897391627","10886449759838578778794958307788047941406785242549633914108449829812392048370","17448162773451716903652656956672153620527078997008288220134626679569204793885","8193208551722424163672760295188085817978882325532362392536117848641938167432","5188231056634691886901999161916368857835161007631558153579677327028342265948","9853490881600813408992538194957656298724824531225826851107601002818525084222","17176698265829847185997577163037131773171792701293793712275669669265274575299","2382186195648146516341654351928344476719352813571512757658711218508035747272","17541974316446605514287658198216071907465588761032017945272434980678133194312","12331436899924420628107367602148380508106203666523782250822407566461963632531","1865463775939128849013967540967485262174806274156493886030340039623063023011","13664136366074157828981805087063103415786585939847799531756194750629171953230","8961535426401724955607435380784730879470213695991219778175985710510755851062","14745562498609525597655429529678348395686699212093700471339778801253874954779","11708891390762541868361261067641552559912421095674886588248224465041801556866","11906002685889231048628876735506556722795690139994069878942691036590028683509","4178469206808655059587684262182139415123238426313925830149210739668495467868","15029761566708188353382815398388042763718992671318396637647637111324724559432","9845689086794432697950142959920657201231525203825153152672084479756532304121","12455780353077741849258477960837296857815250022714279406535072077098170802543","1160246031082260209147492503226616381502977646181531303881882899298072453106","14078024022071871330815652222033954717829368294736866112590107689019410013063","16775915145652694199341869739457987348758535073751277830766151832305637833508","8725756114897057006471956354680892770358730006266612800548323238466152125079","12151982433518358092888092465518383700231770633270250016570935744810577169283","10728296937360698647062460026507024752934118457089207277551563134879542053502","20269851969269753722780527510114165955244208890569768184778857008320987686760","19494075507757984815270710564509367019898284389287318072677097812399644024508","17637642984828037681540509668963952460505267030364810428894747003684677135595","17383381471841195157889938807771978831466989045392704279645779193831112545422","15467369587754369616119430374290282742535096785809897895367057783927514200513","7462506923522654413867327754204782466622786734620482536583897230194600801278","12205454072728419450026993174204658297944243499091159221047232752634315064856","8952919921679303189638927145270375778470987989994324508705836558210763982985","17608601216815822433278317245267274595024522039046184748831789655217392659836","9241702157474599732559529672569491882034463950833136295080713580647607229096","18698557080378060947192451213384063411776576848628159393575372017955756286333","6394919057730632319948916996676618085361670484093305941135454225016366152976","12153421092282420599996475562898341552842067296645706716979892699105035994933","215839608222374881307388279952466901983580908365223518003699240752543310289","12305860472041645003681445995192823056576995215550163290043208665839978548980","18832670206702302548392666385036404183107727393337192136547186564289457663315","4591368403927625491749074782435001924910820619036723584370674243352179028940","17900192414497281035694867559738507342621015006275780130859116495235712701598","12504246887428381177747713324707242055879932306619857846913928458936833510269","21253577517963245519388409695387314540206167371895880381986068524818550266365","7052333411272534204379255859399695101389881358964518717807945369497502329738","3119878324664806761134488045581914971146047153266473112975324269789873464204","2701893796338699558243409648289096824294480171669318483110260094051784426220","14227342316731399216428192523821854165456931577611530621112595224352644344890","20686090714000482245722868774933574216705194808231413047926042752659516684888","14730392831461327135241031670503095138078537817649625675013908357698946274479","8103799806305834521662265061529388402616702714704710650866621181452959357803","2711705237752438635715740759390355350562541125202490960763204724683112708383","15046820701074765172704217742347850669173403683118150740146186544028637413913","2596946739636900573284683925597541432531010064996246541633636663242976696170","6296694301989079697806826207613884618676049914187550158792165165941482591601","14507181737269456659778556763702879126249778101720338410522447254565957233253","4421775667159195126142522170277398979054432524490461527270458342074323026271","19308380191718136725510820602573978938469904856221708575452412749996811525331","2141081057456121096675126344497314884739402017182137956619402690458477157541","10914845538874613584453455481092047696229279197922785674592663971379977059792","286457142387254324695390572708840948093810625877794118883817844335327482287","7466156084240207319553593745160825991347565161476053434755823678907033038595","8601360368104632721166501572488579372004657115449372121196050057522852026807","20772311972116717429414396011751518546090351849187335759170627506606187807438","16053513590886520325967814050720536933824282587758921357636655789779518645255","17659396802837439347272679025148715802261912675214585090248912263424770835406","4657491866740685436972694670954762223492737236225772502264009824627461425217","696680673511439294358019256005810424531529683264616805101076968789426842506","3769586662124906900091811856640994167874736293477928438574934484397006096912","4397089870855670547538401528274574869309795522344264987239796596783860543971","13363272555163729543990006401570230160129506007703740850996715382301884115444","4414540671282892753808266393534011282082139722991144496461590820325662467311","16688302563624770602666394219313541867819852292463441233231654315872781925947","17404735913419478522233092399648226329284853957330471091812762628435131146694","4803536056719744154718056703370982491460182543573593405430321912468422252014","3670712993697412833271017765819060381075991979157667112819548749844925230535","15564376581549239284970277573033942823364047950073809879179522514759773737358","5278646911946589529713681177634895214373927499935740670335437661614275087915","17442174716041923362528061536670240263247818150820072813393684191657574993759","11942532704417936250828775751475965036549281404836010501284703122805145228345","14000169047111434324664362825284228281271812775947935197230284079186713466025","19569469321788489838504695874051862267127597134459048604696675046766965049276","2615544618010860056789565646255886474203461763998793193045203291910845214542","14895178318195335009351714314358340740240098440150924073609610767000483602010","17866919881396226232476702429036333268164898645462159991602791228565892390063","16472364203559191741939892511814795281744165954227652188868241127183561798877","238165047421874401287430531643519413515808034916700912580144603191972199773","10349771662050118773585035624612765506148115369857513286536062081830540374194","3097263274191277854844060282516792433233597405867717567316901088771267028206","9058381188547191838363053439821048422905659143202880972172244543812264449456","7433069272036359523335474016440752857114363421360703184596155228701308729595","18119919727337069401144179450798829175742589834909128598528054437994516369926","18571976704521842843794817890752225340567469934001590914835272175267480764273","19739700988747747965141760896957951818743173707364602516580134769305913380533","5227387279433304813686429695362693662807486099253008616032946527093170068620","10325023519429412763484294011949477847458151548337888760025079443173081418957","20396373548464422526211591888592067388855191661369435450124136671440225579758","16261651873701027444476189551055041878842853644529420332294361207822914794918","16501422577550551444996785503984278776004207294478323585218840595210200428796","4727230835850618049882102429632496651955170214176857471371540952729194467552","8452770515966556147588025179370679853854152114648492462517345725047922924460","5797226943074240719382613207192518594274849797149070015602578346499652002828","7231228947486894046389385375828868059163914592850155276012881323978268903586","16580819278972603217135778045365558529171902809694693225523729735937566659413","4203683961625485451754427561281334750017402264312955006604392261592152147476","12011370554154238470646360439443238717225809138632283322791581496844575939669","17604951324120888390705592498427501096787410189007809862547566853768750758867","1797750604834595075531125428471549609018956286078642416789168328073532390852","1747817368641658144588086134268231747754314331036727682980521446304466437581","128139704430059813866344027681896009390292952626708102870780146576898175313","4859809075411878825458777699145422376304591244938219176310684246726636466746","16261762783032565449044359574726086561019894774170165875632302027285405491932","9383007949200707192395296649675944810792638125632013349064951524082110942598","15563018867793043737781439089321576025811986924594568958984637396065518574243","17788532051904524485365962030117219254938486330276916534800352751175231099240","5604387850293579394464973116701957324901963228474390995659794746774178424658","3449225056343582810163279551032868790178210907495893487418411603238901872499","8637780271293145433615019140609289598263286573424154439019781645018299253548","18194944017981896804173400987829444770921427055362683278219980401421454721659","7867728924865037835957169260028179947908302385339161158358902309049442859912","19405505170837386499660475898424272652825390274679004222577386748374105053274","2687807046966955094865404386465995668315978614683556792158365990637212060610","14195875152379457882257159346148971562097151856039556864596775123661120073878","5057092894739129840270533374656083528534306278434461551379186573160244346620","1740902522279911326812349154988826183764701994792720756593811638854398688584","19289084576987384821953763655256393922869169960488090298597205350445355792849","429936479817251154665731693346197994363710909830452756069438248046925548005","15880734395127479298430715497598422842685643932613401844664139224614189668269","14557322288332841581459791689728765268844154566623573960973142050466976548370","9317671005296475263477022162173225260858147252889838784239967825275048473882","15972343794797847795120588179011876789383001962073235144312547651409129670576","12051718635591775846727060130976502265128109374198539897919309591790024333415","14927540727310739215977330374231201428941690059855145858444490153370177306103","7836115244026729657281962055090632487019664718936177506764916397979254777330","17668880300371859895555503482581498742155526040763107308996026214012157090901","15563088544159127354877746476896695154590419404811115857431574992194653953436","11893742897166171824302102278894904201595920332314898690795814612055345053177","9689016567128331709433809322889597176595321286312611265517848090137964355079","19309098973741103314699640378496459938103388697468340882322523885234552530037","18813868992455790754065980347254685439591601972771712168695197187364714979067"]
```
This is what we get as witness. Here you can notice the inputs that we have given `8th` & `9th` element of witness.

Now the most important part of the challenge reading and understanding the witness, because simply some set of values which we can't understand.

### Let me walk you through the witness data

- 1st element of `witness` - `1` tells us the circuit is sucessfully compiled with the given inputs.
- After that we will have all the ouput values sequentially in the way they have been declare in the cicuit.

    - Sequence of ouputs in which they have been declared
    `g, h, leaked_hash, leaked_commiment, leaked_hash`.
    
    Therefore - 
    `g`: 5 
    `h`: 7 
    `leaked_commitment`: 3077441
    `leaked_hash`: 8300557270016853654217686415541469010953091753111651488749227335704826383295
    
    These are all the ouputs in the circuit and we have mapped it.

- After this all the values are of input.
    - Sequence of inputs in which they have been declared
    `prime, pre_commitment, challenge, randomizer, blinding_factor`.
    
    Therefore - 
    `prime`: 8995003 
    `pre_commitment`: 5188827
    `challenge`: 4497502
    `randomizer`: 4497502
    `blinding_factor`: xxxxxxx
    
So this the the value that no one can see, we have to find its hash and by reading the circuit we actually need `Poseidon hash` of `reaminder` & `blinding_factor`.

Then by analyzing the circuit and understanding how the commitment is generating we can find the the `blinding_factor`.

Finding blinding factor:

```c++

#include <bits/stdc++.h>
#include <math.h>
using namespace std;
#define int long long

// Function to perform modular exponentiation

int32_t main() {
    long long pre_commitment = 5188827, challenge = 4497502, randomizer = 4497502, prime = 8995003;
    long long r = (((pre_commitment * challenge)%prime) + rand) % prime;
    long long g = 5, h = 7, pederson_commitment = 3077441;
    long long val1 = (g * r)%prime;
    for (auto i =1; i < 8995003 + 1; i++) {
        
        long long val2 = (h * i)%prime;
        long long val = (val1 + val2 ) % prime;
        if (pc == val) {
            cout << i << endl;
            break;
        }
    }
    return 0;
}
```

With this will get the `blinding factor`.

Now lets move to `/verify_proof`.

![image](https://github.com/CyberLabs-Infosec/PearlCTF_Challenges_Public_2025/blob/main/crypto/Witness/image/verify_proof.jpg)

Now here as we know the blinding factor.
We can use the same circom circuit with given inputs and `blinding_factor` to get the `User Poseidon Hash`.

and on submiting the hash if it matches, will get the flag.

#### Flag
##### ***`pearlCTF{C1rC0m_C1rCu1ts_4r3_Fun_!!!!}`***
